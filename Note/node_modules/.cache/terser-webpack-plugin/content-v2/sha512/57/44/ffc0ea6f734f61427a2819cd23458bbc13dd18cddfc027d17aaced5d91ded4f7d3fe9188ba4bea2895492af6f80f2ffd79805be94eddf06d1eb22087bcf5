{"code":"!function(t){var e={};function n(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)n.d(a,i,function(e){return t[e]}.bind(null,i));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=0)}([function(t,e,n){\"use strict\";n.r(e);var a=class{constructor(t,e){this.target=t,this.name=\"createShape\",this.UnRedo=e}action(){[\"Rect\",\"Circle\",\"Textbox\"].forEach(t=>{const e=document.createElement(\"li\");e.id=t,e.className=\"tag\",e.addEventListener(\"click\",()=>{this.target.isDrawingMode=!1,this.selectType(t)}),document.getElementById(\"tag-wrapper\").appendChild(e)})}selectType(t){let e,n;this.target.renderAll(),this.target.forEachObject((function(t){t.selectable=!1})),\"Textbox\"===t?this.target.on(\"mouse:down\",t=>{e=t.absolutePointer.x,n=t.absolutePointer.y;const a=new fabric.Textbox(\"this is sample\",{left:e,top:n});this.target.add(a),this.target.renderAll(),this.target.forEachObject((function(t){t.selectable=!0})),this.target.off(\"mouse:down\"),this.UnRedo.updateCanvas()}):(console.log(\"hello\"),this.target.on(\"mouse:down\",t=>{e=t.absolutePointer.x,n=t.absolutePointer.y}),this.target.on(\"mouse:up\",a=>{const i=a.absolutePointer.x,o=a.absolutePointer.y;this.create(e,n,i,o,t),this.target.off(\"mouse:down\"),this.target.off(\"mouse:up\"),this.target.renderAll(),this.target.forEachObject((function(t){t.selectable=!0})),this.UnRedo.updateCanvas()}))}create(t,e,n,a,i){let o,s;t-n>0&&e-a>0?(o=n,s=a):t-n>0&&e-a<0?(o=n,s=e):t-n<0&&e-a>0?(o=t,s=a):(o=t,s=e);const r={left:o,top:s,fill:\"#ccc\",stroke:\"#000\"};if(\"Rect\"===i){const i=new fabric.Rect({...r,width:Math.abs(t-n),height:Math.abs(e-a)});console.log(\"hi\"),this.target.add(i)}else{const e=new fabric.Circle({...r,radius:Math.abs(t-n)/2});console.log(\"hi\"),this.target.add(e)}}};var i=class{constructor(t){this.name=\"UnRedo\",this.target=t,this.mods=0,this.state=[],this.isUndo=!1,this.target.on(\"object:modified\",()=>{this.updateCanvas()}),this.target.on(\"path:created\",()=>{this.updateCanvas()}),this.target.on(\"object:removed\",()=>{this.updateCanvas()})}action(){window.addEventListener(\"keydown\",t=>{\"z\"===t.key&&t.ctrlKey?this.undo():\"y\"===t.key&&t.ctrlKey&&this.redo()})}updateCanvas(){for(;this.isUndo;)this.state.pop(),this.isUndo--,this.mods=0;const t=JSON.stringify(this.target);this.state.push(t),console.log(this.state)}undo(){this.mods<this.state.length&&(this.target.clear().renderAll(),this.target.loadFromJSON(this.state[this.state.length-this.mods-2]),this.isUndo=this.mods+1,this.target.renderAll(),console.log(this.state.length-1-this.mods-1),this.mods+=1)}redo(){this.mods>0&&(this.target.clear().renderAll(),this.target.loadFromJSON(this.state[this.state.length-this.mods]),this.target.renderAll(),this.isUndo=this.mods-1,console.log(this.state.length-1-this.mods+1),this.mods-=1)}};var o=class{constructor(t){this.target=t,this.name=\"drawing\",window.onkeydown=t=>{\"y\"===t.key&&(this.target.isDrawingMode=!this.target.isDrawingMode)}}action(){this.target.isDrawingMode=!this.target.isDrawingMode}};var s=class{constructor(t,e,n){this.target=t,this.array=e,this.user=n}action(){this.displayModal(),document.getElementById(\"submit\").addEventListener(\"click\",()=>{const t=new Date;this.array.unshift({userName:this.user,title:document.getElementById(\"title\").value,explanation:document.getElementById(\"explanation\").value,date:t.getMonth+\"/\"+t.getDay+\"/\"+t.getHours+\"/\"+t.getMinutes,data:JSON.stringify(this.target),icon:\"\"}),console.log(this.array)})}displayModal(){const t=document.createElement(\"div\"),e=document.createElement(\"div\"),n=document.createElement(\"input\"),a=document.createElement(\"textarea\"),i=document.createElement(\"button\");t.id=\"modal-wrapper\",e.id=\"modal\",n.id=\"title\",n.placeholder=\"タイトル\",a.id=\"explanation\",a.placeholder=\"作品の説明\",i.id=\"submit\",i.innerHTML=\"投稿\",document.body.appendChild(t),t.appendChild(e),e.appendChild(n),e.appendChild(a),e.appendChild(i)}};const r=new class{constructor(){this.canvasSize=document.getElementById(\"canvas\"),this.canvasSize.height=document.getElementById(\"canvas-wrapper\").clientHeight,this.canvasSize.width=document.getElementById(\"canvas-wrapper\").clientWidth,this.board=new fabric.Canvas(\"canvas\"),this.board.freeDrawingBrush.color=\"#2b2b2b\",this.board.freeDrawingBrush.width=8}resize(){this.board.setWidth(window.innerWidth),this.board.setWidth(window.innerHeight)}createTool(t){const e=document.getElementById(\"tag-wrapper\"),n=document.createElement(\"li\");n.className=\"tag\",n.id=t,e.appendChild(n)}};window.onresize=async()=>{const t=document.getElementById(\"canvas-wrapper\");r.board.setWidth(t.clientWidth),r.board.setHeight(t.clientHeight)};const d=new i(r.board),c=new a(r.board,d),l=new o(r.board),h=new s;d.action(),window.onkeydown=t=>{\"y\"===t.key?r.board.isDrawingMode=!r.board.isDrawingMode:\"Delete\"===t.key&&r.board.remove.apply(r.board,r.board.getActiveObjects())},window.onload=()=>{Array(l,c,h).forEach(t=>{r.createTool(t.name),document.getElementById(t.name).addEventListener(\"click\",()=>{t.action()})})}}]);","extractedComments":[]}