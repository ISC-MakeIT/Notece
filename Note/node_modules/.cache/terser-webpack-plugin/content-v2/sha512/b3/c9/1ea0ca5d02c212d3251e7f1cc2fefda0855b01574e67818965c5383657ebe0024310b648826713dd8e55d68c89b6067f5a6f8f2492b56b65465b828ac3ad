{"code":"!function(t){var e={};function s(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var n in t)s.d(o,n,function(e){return t[e]}.bind(null,n));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,\"a\",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p=\"\",s(s.s=0)}([function(t,e,s){\"use strict\";s.r(e);var o=class{constructor(t,e){this.target=t,this.name=\"createShape\",this.UnRedo=e}action(){[\"Rect\",\"Circle\",\"Textbox\"].forEach(t=>{const e=document.createElement(\"li\");e.id=t,e.className=\"tag\",e.addEventListener(\"click\",()=>{this.target.isDrawingMode=!1,this.selectType(t)}),document.getElementById(\"tag-wrapper\").appendChild(e)})}selectType(t){let e,s;this.target.renderAll(),this.target.forEachObject((function(t){t.selectable=!1})),\"Textbox\"===t?this.target.on(\"mouse:down\",t=>{e=t.absolutePointer.x,s=t.absolutePointer.y;const o=new fabric.Textbox(\"this is sample\",{left:e,top:s});this.target.add(o),this.target.renderAll(),this.target.forEachObject((function(t){t.selectable=!0})),this.target.off(\"mouse:down\"),this.UnRedo.updateCanvas()}):(console.log(\"hello\"),this.target.on(\"mouse:down\",t=>{e=t.absolutePointer.x,s=t.absolutePointer.y}),this.target.on(\"mouse:up\",o=>{const n=o.absolutePointer.x,i=o.absolutePointer.y;this.create(e,s,n,i,t),this.target.off(\"mouse:down\"),this.target.off(\"mouse:up\"),this.target.renderAll(),this.target.forEachObject((function(t){t.selectable=!0})),this.UnRedo.updateCanvas()}))}create(t,e,s,o,n){let i,a;t-s>0&&e-o>0?(i=s,a=o):t-s>0&&e-o<0?(i=s,a=e):t-s<0&&e-o>0?(i=t,a=o):(i=t,a=e);const r={left:i,top:a,fill:\"#ccc\",stroke:\"#000\"};if(\"Rect\"===n){const n=new fabric.Rect({...r,width:Math.abs(t-s),height:Math.abs(e-o)});console.log(\"hi\"),this.target.add(n)}else{const e=new fabric.Circle({...r,radius:Math.abs(t-s)/2});console.log(\"hi\"),this.target.add(e)}}};var n=class{constructor(t){this.name=\"UnRedo\",this.target=t,this.mods=0,this.state=[],this.isUndo=!1,this.target.on(\"object:modified\",()=>{this.updateCanvas()}),this.target.on(\"path:created\",()=>{this.updateCanvas()}),this.target.on(\"object:removed\",()=>{this.updateCanvas()})}action(){window.addEventListener(\"keydown\",t=>{\"z\"===t.key&&t.ctrlKey?this.undo():\"y\"===t.key&&t.ctrlKey&&this.redo()})}updateCanvas(){for(;this.isUndo;)this.state.pop(),this.isUndo--,this.mods=0;const t=JSON.stringify(this.target);this.state.push(t),console.log(this.state)}undo(){this.mods<this.state.length&&(this.target.clear().renderAll(),this.target.loadFromJSON(this.state[this.state.length-this.mods-2]),this.isUndo=this.mods+1,this.target.renderAll(),console.log(this.state.length-1-this.mods-1),this.mods+=1)}redo(){this.mods>0&&(this.target.clear().renderAll(),this.target.loadFromJSON(this.state[this.state.length-this.mods]),this.target.renderAll(),this.isUndo=this.mods-1,console.log(this.state.length-1-this.mods+1),this.mods-=1)}};var i=class{constructor(t){this.target=t,this.name=\"drawing\",window.onkeydown=t=>{\"y\"===t.key&&(this.target.isDrawingMode=!this.target.isDrawingMode)}}action(){this.target.isDrawingMode=!this.target.isDrawingMode}};const a=new class{constructor(){this.canvasSize=document.getElementById(\"canvas\"),this.canvasSize.height=document.getElementById(\"canvas-wrapper\").clientHeight,this.canvasSize.width=document.getElementById(\"canvas-wrapper\").clientWidth,this.board=new fabric.Canvas(\"canvas\"),this.board.freeDrawingBrush.color=\"#2b2b2b\",this.board.freeDrawingBrush.width=8}resize(){this.board.setWidth(window.innerWidth),this.board.setWidth(window.innerHeight)}createTool(t){const e=document.getElementById(\"tag-wrapper\"),s=document.createElement(\"li\");s.className=\"tag\",s.id=t,e.appendChild(s)}};window.onresize=async()=>{const t=document.getElementById(\"canvas-wrapper\");a.board.setWidth(t.clientWidth),a.board.setHeight(t.clientHeight)};const r=new n(a.board),d=new o(a.board,r),c=new i(a.board);console.log(timelineLog),r.action(),window.onkeydown=t=>{\"y\"===t.key?a.board.isDrawingMode=!a.board.isDrawingMode:\"Delete\"===t.key&&a.board.remove.apply(a.board,a.board.getActiveObjects())},window.onload=()=>{Array(c,d,post).forEach(t=>{a.createTool(t.name),document.getElementById(t.name).addEventListener(\"click\",()=>{t.action()})})}}]);","extractedComments":[]}